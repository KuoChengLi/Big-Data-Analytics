import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
from sklearn.ensemble import ExtraTreesClassifier
data=pd.read_csv("C:/Users/.../Desktop/LargeTrain.csv")

data_=data.drop(['Class'], axis=1)
class_=pd.DataFrame(data, columns=['Class'])

forest = ExtraTreesClassifier(n_estimators=1000, random_state=0, criterion="gini")
forest.fit(data_,class_)

importances = forest.feature_importances_
std = np.std([tree.feature_importances_ for tree in forest.estimators_], axis=0)
indices = np.argsort(importances)[::-1]

df1=[]
for i in range(10):
    df1.append({'feature':data.columns.values[indices[i]], 'importances':importances[indices[i]]})
pd.DataFrame(df1)

df2=[]
for i in range(data_.shape[1]):
    if importances[indices[i]]==0:
        df2.append({'feature':data.columns.values[indices[i]], 'importances':importances[indices[i]]})
pd.DataFrame(df2)

plt.figure()
plt.title("Feature importances")
plt.bar(range(data_.shape[1]), importances[indices], color="red", yerr=std[indices], align="center")
plt.xticks(range(data_.shape[1]), indices)
plt.xlim([-1,data_.shape[1]])
plt.show() 
